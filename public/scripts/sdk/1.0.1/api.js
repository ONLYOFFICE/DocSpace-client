"use strict";(()=>{var C="/api/2.0/security/csp",f="frameDocSpace",m={src:"",rootPath:"/rooms/shared/",requestToken:null,width:"100%",height:"100%",name:f,type:"desktop",frameId:"ds-frame",mode:"manager",id:null,locale:null,theme:"System",editorType:"desktop",editorGoBack:!0,selectorType:"all",showSelectorCancel:!1,showSelectorHeader:!1,showHeader:!1,showHeaderBanner:"none",showTitle:!0,showMenu:!1,showFilter:!1,showSignOut:!0,destroyText:"",viewAs:"row",viewTableColumns:"Index,Name,Size,Type,Tags",checkCSP:!0,disableActionButton:!1,showSettings:!1,waiting:!1,noLoader:!1,withSearch:!0,withBreadCrumbs:!0,withSubtitle:!0,filterParam:"ALL",buttonColor:"#5299E0",infoPanelVisible:!0,downloadToEvent:!1,filter:{count:"100",page:"1",sortOrder:"descending",sortBy:"DateAndTime",search:"",withSubfolders:!1},editorCustomization:{},events:{onSelectCallback:null,onCloseCallback:null,onAppReady:null,onAppError:null,onEditorCloseCallback:null,onAuthSuccess:null,onSignOut:null,onDownload:null,onNoAccess:null,onNotFound:null,onContentReady:null,onEditorOpen:null}},p="The current domain is not set in the Content Security Policy (CSP) settings.",b="Message bus is not connected with frame";var c=t=>t?(Object.keys(t).forEach(e=>(t[e]===void 0||t[e]===null)&&delete t[e]),new URLSearchParams(t).toString()):"",w=async t=>{let{origin:e,host:r}=window.location;if(e.includes(t))return;let s=await fetch(`${t}${C}`,{method:"get",headers:new Headers({"ngrok-skip-browser-warning":"69420"})}),o;try{o=await s.json()}catch(i){throw new Error(`CSP validation failed: ${i}`)}let{response:{domains:n}}=o,a=r||new URL(e).host;if(!n.map(i=>{try{let u=new URL(i.toLowerCase());return u.host+(u.pathname!=="/"?u.pathname:"")}catch{return i}}).includes(a.toLowerCase()))throw new Error(p)},T=t=>`<body style=background:#f3f4f4><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300"rel=stylesheet><div style="display:flex;flex-direction:column;gap:80px;align-items:center;justify-content:flex-start;margin-top:60px;padding:0 30px"><div style=flex-shrink:0;width:211px;height:24px;position:relative><img src=${t}/static/images/logo/lightsmall.svg></div><div style=display:flex;flex-direction:column;gap:16px;align-items:center;justify-content:flex-start;flex-shrink:0;position:relative><div style=flex-shrink:0;width:120px;height:100px;position:relative><img src=${t}/static/images/frame-error.svg></div><span style="color:#a3a9ae;text-align:center;font-family:Open Sans;font-size:14px;font-style:normal;font-weight:700;line-height:16px">${p} Please add it via <a href=${t}/portal-settings/developer-tools/javascript-sdk style="color:#4781d1;text-align:center;font-family:Open Sans;font-size:14px;font-style:normal;font-weight:700;line-height:16px;text-decoration-line:underline"target=_blank>the Developer Tools section</a>.</span></div></div></body>`,y=t=>`@keyframes rotate { 0%{ transform: rotate(-45deg); } 15%{ transform: rotate(45deg); } 30%{ transform: rotate(135deg); } 45%{ transform: rotate(225deg); } 60%, 100%{ transform: rotate(315deg); } } .${t} { width: 74px; height: 74px; border: 4px solid rgba(51,51,51, 0.1); border-top-color: #333333; border-radius: 50%; transform: rotate(-45deg); position: relative; box-sizing: border-box; animation: 1s linear infinite rotate; } @media (prefers-color-scheme: dark) { .${t} { border-color: rgba(204, 204, 204, 0.1); border-top-color: #CCCCCC; } }`,S=()=>{let t=document.currentScript,e=new URL(decodeURIComponent(t.src)).searchParams,r={...m};return e.forEach((s,o)=>{let n=s==="true"?!0:s==="false"?!1:s;m.filter&&o in m.filter?r.filter[o]=n:r[o]=n}),r.mode=e.get("mode")||"manager",r.src=e.get("src")||"",r},E=t=>{switch(t.mode){case"manager":{t.id&&(t.filter.folder=t.id);let e=t.requestToken?{key:t.requestToken,...t.filter}:t.filter;e?.withSubfolders||delete e?.withSubfolders;let r=c(e);return`${t.rootPath}${t.requestToken?`?${r}`:`${t.id?t.id+"/":""}filter?${r}`}`}case"room-selector":{let e={acceptLabel:t.acceptButtonLabel,cancel:t.showSelectorCancel,cancelLabel:t.cancelButtonLabel,header:t.showSelectorHeader,locale:t.locale,roomType:t.roomType,search:t.withSearch,theme:t.theme},r=c(e);return`/sdk/room-selector${r?`?${r}`:""}`}case"file-selector":{let e={acceptLabel:t.acceptButtonLabel,breadCrumbs:t.withBreadCrumbs,cancel:t.showSelectorCancel,cancelLabel:t.cancelButtonLabel,filter:t.filterParam,header:t.showSelectorHeader,id:t.id,locale:t.locale,roomType:t.roomType,search:t.withSearch,selectorType:t.selectorType,subtitle:t.withSubtitle,theme:t.theme},r=c(e);return`/sdk/file-selector${r?`?${r}`:""}`}case"public-room":{let e={theme:t.theme,locale:t.locale,folder:t.id,key:t.requestToken},r=c(e);return`/sdk/public-room${r?`?${r}`:""}`}case"system":return"/old-sdk/system";case"editor":{t?.editorCustomization&&((t?.editorCustomization).uiTheme=t.theme),(!t.id||t.id==="undefined"||t.id==="null")&&(t.id=-1),t.events?.onEditorCloseCallback&&typeof t.events.onEditorCloseCallback=="function"&&(t.editorGoBack="event");let e=`/doceditor?fileId=${t.id}&editorType=${t.editorType}`;return t.requestToken?`${e}&share=${t.requestToken}&is_file=true`:e}case"viewer":{t?.editorCustomization&&((t?.editorCustomization).uiTheme=t.theme),(!t.id||t.id==="undefined"||t.id==="null")&&(t.id=-1),t.events?.onEditorCloseCallback&&typeof t.events.onEditorCloseCallback=="function"&&(t.editorGoBack="event");let e=`/doceditor?fileId=${t.id}&editorType=${t.editorType}&action=view`;return t.requestToken?`${e}&share=${t.requestToken}&is_file=true`:e}default:return t.rootPath}};var d=class t{#o=!1;#l="0";#t=[];#r=[];#s="";config;constructor(e){this.config=e}static _loaderCache={style:new Map,container:document.createElement("div")};#m=e=>{let{frameId:r,width:s,height:o}=e,n=`${r}-loader__element`;if(!t._loaderCache.style.has(n)){let i=document.createElement("style");i.textContent=y(n),document.head.append(i),t._loaderCache.style.set(n,i)}let a=t._loaderCache.container.cloneNode();a.id=`${r}-loader`,Object.assign(a.style,{width:s,height:o,display:"flex",justifyContent:"center",alignItems:"center"});let l=document.createElement("div");return l.className=n,a.append(l),a};#c=e=>{let r=document.createElement("iframe"),s=E(e);return Object.assign(r,{id:e.frameId,src:e.src+s,name:`${f}__#${e.frameId}`,allowFullscreen:!0}),Object.assign(r.style,{width:e.width,height:e.height,border:"0px",...e.type==="mobile"&&{position:"fixed",overflow:"hidden"}}),r.setAttribute("allow","storage-access *"),e.type==="mobile"&&(document.body.style.overscrollBehaviorY="contain"),e.checkCSP&&requestAnimationFrame(()=>{w(e.src).catch(o=>{e.events?.onAppError?.(o.message),r.srcdoc=T(e.src),this.setIsLoaded()})}),r};#n=e=>{let r=document.getElementById(this.config.frameId);r?.contentWindow&&r.contentWindow.postMessage(JSON.stringify({frameId:this.config.frameId,type:"",data:e},(s,o)=>typeof o=="function"?o.toString():o),this.config.src)};#i=e=>{if(typeof e.data!="string")return;let r=this.#d(e.data);if(r.frameId===this.config.frameId)switch(r.type){case"onMethodReturn":this.#h(r);break;case"onEventReturn":r.eventReturnData&&this.#u(r.eventReturnData);break;case"onCallCommand":this.#f(r);break;case"error":r.error&&this.#a(r.error);break}};#d(e){try{return JSON.parse(e)}catch(r){return console.warn("Failed to parse message:",r),{frameId:"error",type:"error",commandName:"parseMessageData",error:{message:"Invalid message format"}}}}#h(e){this.#t.shift()?.(e.methodReturnData),this.#r.length>0&&this.#n(this.#r.shift())}#u(e){if(!e?.event)return;let r=e.event,s=this.config.events?.[r];if(typeof s=="function")try{s(e.data)}catch(o){console.error("Event handler failed:",r,o)}}#f(e){let r=this[e.commandName];typeof r=="function"&&r.call(this,e.commandData)}#a(e){console.error("SDK Error:",e),this.config.events?.onAppError?.(e.message)}#p(e,r,s){if(!this.#o){this.#a({message:b});return}this.#t=[...this.#t,s];let o={type:"method",methodName:e,data:r};this.#t.length>1?this.#r=[...this.#r,o]:this.#n(o)}setIsLoaded(){let e=this.config.frameId,r=document.getElementById(e),s=r?.parentElement;if(!r||!s)return;Object.assign(r.style,{opacity:"1",position:"relative",width:this.config.width,height:this.config.height}),s.style.height=this.config.height,document.getElementById(`${e}-loader`)?.remove(),this.config.events?.onContentReady?.()}initFrame(e){this.config={...this.config,...m,...e};let r=document.getElementById(this.config.frameId);if(!r)return null;this.#s=r.className;let s=document.createDocumentFragment(),o=document.createElement("div");Object.assign(o,{id:this.config.frameId+"-container",className:"frame-container"}),Object.assign(o.style,{position:"relative",width:this.config.width,height:this.config.height});let n=this.#c(this.config);if(Object.assign(n.style,{opacity:this.config.noLoader?"1":this.#l,zIndex:"2",position:this.config.noLoader?"relative":"absolute",width:"100%",height:"100%",top:"0",left:"0"}),(!this.config.waiting||this.config.mode==="system")&&s.appendChild(n),!this.config.noLoader){let l=this.#m(this.config);s.appendChild(l)}return o.appendChild(s),r.parentNode?.isEqualNode(document.getElementById(this.config.frameId+"-container"))?r.parentNode?.replaceWith(o):r.replaceWith(o),window.addEventListener("message",this.#i,!1),this.#o=!0,window.DocSpace.SDK.frames=window.DocSpace.SDK.frames||{},window.DocSpace.SDK.frames[this.config.frameId]=this,n}destroyFrame(){let e=this.config.frameId,r=document.getElementById(e),s=window.DocSpace?.SDK?.frames;r&&(r.innerHTML=this.config.destroyText||"",r.className=this.#s,r.replaceWith(r.cloneNode(!1))),window.removeEventListener("message",this.#i,!1),this.#o=!1,s&&delete s[e]}#e=(e,r=null)=>new Promise(s=>{this.#p(e,r,o=>s(o))});setConfig(e=m){return this.config={...this.config,...e},this.#e("setConfig",this.config)}getConfig(){return this.config}getFolderInfo(){return this.#e("getFolderInfo")}getSelection(){return this.#e("getSelection")}getFiles(){return this.#e("getFiles")}getFolders(){return this.#e("getFolders")}getList(){return this.#e("getList")}getRooms(e){return this.#e("getRooms",e)}getUserInfo(){return this.#e("getUserInfo")}getHashSettings(){return this.#e("getHashSettings")}openModal(e,r){return this.#e("openModal",{type:e,options:r})}createFile(e,r,s,o){return this.#e("createFile",{folderId:e,title:r,templateId:s,formId:o})}createFolder(e,r){return this.#e("createFolder",{parentFolderId:e,title:r})}createRoom(e,r,s,o,n,a,l,i){return this.#e("createRoom",{title:e,roomType:r,...s!==void 0&&{quota:s},...i!==void 0&&{denyDownload:i},...o!==void 0&&{tags:o},...n!==void 0&&{color:n},...a!==void 0&&{cover:a},...l!==void 0&&{indexing:l}})}setListView(e){return this.#e("setListView",{viewType:e})}createHash(e,r){return this.#e("createHash",{password:e,hashSettings:r})}login(e,r,s,o){return this.#e("login",{email:e,passwordHash:r,...s!==void 0&&{password:s},...o!==void 0&&{session:o}})}logout(){return this.#e("logout")}createTag(e){return this.#e("createTag",{name:e})}addTagsToRoom(e,r){return this.#e("addTagsToRoom",{roomId:e,tags:r})}removeTagsFromRoom(e,r){return this.#e("removeTagsFromRoom",{roomId:e,tags:r})}getEditorInstance(){return this.#e("getEditorInstance")}};var h=class{instances=[];frames={};init=e=>{let{frameId:r}=e,s=this.frames[r];if(s)return s.initFrame(e),s;let o=new d(e);return o.initFrame(e),this.frames[r]=o,this.instances.push(o),o};initFrame=e=>this.init(e);initManager=e=>this.init({...e,mode:"manager"});initViewer=e=>this.init({...e,mode:"viewer"});initEditor=e=>this.init({...e,mode:"editor"});initRoomSelector=e=>this.init({...e,mode:"room-selector"});initFileSelector=e=>this.init({...e,mode:"file-selector"});initSystem=e=>this.init({...e,mode:"system"})};window.DocSpace=window.DocSpace||{};var F=S();window.DocSpace.SDK=window.DocSpace.SDK||new h;F?.init&&window.DocSpace.SDK.init(F);})();
